(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{576:function(e,t,s){e.exports=s.p+"assets/img/tensorflow_resnet_training.e11af83d.png"},595:function(e,t,s){"use strict";s.r(t);var a=s(9),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h3",{attrs:{id:"问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[e._v("#")]),e._v(" 问题")]),e._v(" "),a("p",[e._v("为了在Apple Silicon的Mac上获得原生支持的Metal加速，我不得不选择Tensorflow（2.5+）进行学习。")]),e._v(" "),a("p",[e._v("但是在按照官方教程通过pypi安装d2l（0.17.3）包的时候（通过"),a("code",[e._v("pip install d2l")]),e._v("），出现了一些依赖问题，导致wheel无法正常生成（旧版的d2l依赖了旧的组件，这些组件是Tensorflow2.5之前的，也就是说forge的arm版里没有）。")]),e._v(" "),a("h3",{attrs:{id:"解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决"}},[e._v("#")]),e._v(" 解决")]),e._v(" "),a("p",[e._v("在安装"),a("code",[e._v("d2l")]),e._v("包的时候，不直接通过pypi安装，而是通过github的release分支进行安装:")]),e._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" git+https://github.com/d2l-ai/d2l-zh@release\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("通过以上方式可以让d2l（2.0.0b0）模块正常安装。")]),e._v(" "),a("p",[e._v("安装完成后，按照"),a("a",{attrs:{href:"https://developer.apple.com/metal/tensorflow-plugin/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Apple官方方法"),a("OutboundLink")],1),e._v("安装tensorflow的metal插件，便可获得GPU加速。（其实应该先完成此步骤对GPU版Tensorflow的安装，再安装d2l包。）")]),e._v(" "),a("h3",{attrs:{id:"测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[e._v("#")]),e._v(" 测试")]),e._v(" "),a("p",[e._v("实测：在ResNet的训练中，Colab分配的K80处理样本的速度为790/sec，教程中在win10环境下的2080（移动版）为1990/sec，桌面版2070为2100/sec，桌面版3070ti为4360/sec，而M1 max则为1640/sec。")]),e._v(" "),a("p",[e._v("下面为M1 max在ResNet章中的训练结果（只跑了5个epochs）：")]),e._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:s(576)}}),e._v(" "),a("h3",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),a("p",[e._v("综合来看M1 max以“极低”的功耗（在训练时整机功耗75w左右）产生了不错的算力。用作调参还是勉强可用的。")]),e._v(" "),a("p",[e._v("但目前仅有Tensorflow获得了原生Metal支持且有些小bug，而Pytorch的官方支持目前也仅在issue讨论阶段。")]),e._v(" "),a("p",[e._v("若Apple Silicon的GPU能获得pytorch的原生支持，将是一个让人欣喜的消息。期待🎉")])])}),[],!1,null,null,null);t.default=r.exports}}]);